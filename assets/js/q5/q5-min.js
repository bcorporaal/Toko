/**
 * q5.js
 * @version 2.0-beta20
 * @author quinton-ashley, Tezumie, and LingDong-
 * @license LGPL-3.0
 */
function Q5(e,t){let a,$=this;if($._q5=!0,$._scope=e,$._parent=t,$._preloadCount=0,e||(e="global"),"auto"==e){if(!window.setup&&!window.draw)return;e="global"}"global"==e&&(Q5._hasGlobal=$._isGlobal=!0,a=Q5._nodejs?global:window);let o=new Proxy($,{set:(e,t,o)=>($[t]=o,$._isGlobal&&(a[t]=o),!0)});$.ctx=$.drawingContext=null,$.canvas=null,$.pixels=[];let n=null;$.frameCount=0,$.deltaTime=16,$._targetFrameRate=0,$._targetFrameDuration=16.666666666666668,$._frameRate=$._fps=60,$._loop=!0;let r=0;function i(e){let t=e||performance.now();if($._lastFrameTime??=t-$._targetFrameDuration,$._shouldResize&&($.windowResized(),$._shouldResize=!1),$._loop)n=s(i);else if($.frameCount&&!$._redraw)return;if(n&&$.frameCount){if(t-$._lastFrameTime<$._targetFrameDuration-1)return}o.deltaTime=t-$._lastFrameTime,$._frameRate=1e3/$.deltaTime,o.frameCount++;let a=performance.now();for(let e of Q5.prototype._methods.pre)e.call($);firstVertex=!0,$.ctx&&$.ctx.save(),$.draw();for(let e of Q5.prototype._methods.post)e.call($);$.ctx&&($.ctx.restore(),$.resetMatrix()),o.pmouseX=$.mouseX,o.pmouseY=$.mouseY,$._lastFrameTime=t;let r=performance.now();$._fps=Math.round(1e3/(r-a))}$.millis=()=>performance.now()-r,$.noCanvas=()=>{$.canvas?.remove&&$.canvas.remove(),$.canvas=0,o.ctx=o.drawingContext=0},window&&($.windowWidth=window.innerWidth,$.windowHeight=window.innerHeight,$.deviceOrientation=window.screen?.orientation?.type),$._incrementPreload=()=>o._preloadCount++,$._decrementPreload=()=>o._preloadCount--,$.noLoop=()=>{$._loop=!1,n=null},$.loop=()=>{$._loop=!0,null==n&&i()},$.redraw=(e=1)=>{$._redraw=!0;for(let t=0;t<e;t++)i();$._redraw=!1},$.remove=()=>{$.noLoop(),$.canvas.remove()},$.frameRate=e=>(e&&($._targetFrameRate=e,$._targetFrameDuration=1e3/e),$._frameRate),$.getTargetFrameRate=()=>$._targetFrameRate,$.getFPS=()=>$._fps,$.Element=function(e){this.elt=e},$._elements=[],$.TWO_PI=$.TAU=2*Math.PI,$.log=$.print=console.log,$.describe=()=>{};for(let t in Q5.modules)("image"!=e||Q5.imageModules.includes(t))&&Q5.modules[t]($,o);if("image"==e)return;for(let e in Q5)"_"!=e[1]&&e[1]==e[1].toUpperCase()&&($[e]=Q5[e]);"global"==e&&(Object.assign(Q5,$),delete Q5.Q5);for(let e of Q5.prototype._methods.init)e.call($);for(let[e,t]of Object.entries(Q5.prototype))"_"!=e[0]&&"function"==typeof $[e]&&($[e]=t.bind($));if("global"==e){let e=Object.getOwnPropertyNames($);for(let t of e)"_"!=t[0]&&(a[t]=$[t])}if("function"==typeof e&&e($),"graphics"==e)return;Q5._instanceCount++;let s=window.requestAnimationFrame||function(e){const t=$._lastFrameTime+$._targetFrameDuration;return setTimeout((()=>{e(t)}),t-performance.now())},l=a||$,c=l.preload,d=["setup","draw","preload","mouseMoved","mousePressed","mouseReleased","mouseDragged","mouseClicked","keyPressed","keyReleased","keyTyped","touchStarted","touchMoved","touchEnded","windowResized"];for(let e of d)l[e]?$._isGlobal&&($[e]=()=>{try{l[e]()}catch(e){$._aiErrorAssistance?$._aiErrorAssistance(e):console.error(e)}}):$[e]=()=>{};function h(){if($._startDone=!0,$._preloadCount>0)return s(h);r=performance.now(),$.setup(),$.frameCount||(null===$.ctx&&$.createCanvas(100,100),$._setupDone=!0,$.ctx&&$.resetMatrix(),s(i))}$._isTouchAware=$.touchStarted||$.touchMoved||$.mouseReleased,($.setup||$.draw)&&($._startDone=!1,arguments.length&&"namespace"!=e||c?($.preload(),h()):(l.preload=$.preload=()=>{$._startDone||h()},setTimeout($.preload,32)))}Q5.modules={},Q5.imageModules=["q2d_canvas","q2d_image"],Q5._nodejs="object"==typeof process,Q5._instanceCount=0,Q5._friendlyError=(e,t)=>{throw Error(t+": "+e)},Q5._validateParameters=()=>!0,Q5.prototype._methods={init:[],pre:[],post:[],remove:[]},Q5.prototype.registerMethod=(e,t)=>Q5.prototype._methods[e].push(t),Q5.prototype.registerPreloadMethod=(e,t)=>Q5.prototype[e]=t[e],Q5._nodejs?global.p5??=global.Q5=Q5:"object"==typeof window?window.p5??=window.Q5=Q5:window=0,"object"==typeof document&&document.addEventListener("DOMContentLoaded",(()=>{Q5._hasGlobal||new Q5("auto")})),Q5.modules.q2d_canvas=($,e)=>{$._OffscreenCanvas=window.OffscreenCanvas||function(){return document.createElement("canvas")},Q5._nodejs?Q5._createNodeJSCanvas&&(e.canvas=Q5._createNodeJSCanvas(100,100)):"image"!=$._scope&&"graphics"!=$._scope||(e.canvas=new $._OffscreenCanvas(100,100)),$.canvas||("object"==typeof document?(e.canvas=document.createElement("canvas"),$.canvas.id="q5Canvas"+Q5._instanceCount,$.canvas.classList.add("q5Canvas")):$.noCanvas());let t=$.canvas;if(t.width=$.width=100,t.height=$.height=100,t&&"graphics"!=$._scope&&"image"!=$._scope){$._setupDone=!1;let n=$._parent;function a(){n??=document.getElementsByTagName("main")[0],n||(n=document.createElement("main"),document.body.append(n)),t.parent(n)}n&&"string"==typeof n&&(n=document.getElementById(n)),t.parent=e=>{function a(){$.frameCount>1&&($._shouldResize=!0,$._adjustDisplay())}"string"==typeof e&&(e=document.getElementById(e)),e.append(t),"function"==typeof ResizeObserver?($._ro&&$._ro.disconnect(),$._ro=new ResizeObserver(a),$._ro.observe(n)):$.frameCount||window.addEventListener("resize",a)},document.body?a():document.addEventListener("DOMContentLoaded",a)}function o(a,o){a??=window.innerWidth,o??=window.innerHeight;let n,r=function(){let e={};for(let t in $.ctx)"function"!=typeof $.ctx[t]&&(e[t]=$.ctx[t]);return delete e.canvas,e}();if($.frameCount){n=new $._OffscreenCanvas(t.width,t.height),n.w=t.w,n.h=t.h,n.getContext("2d").drawImage(t,0,0)}t.width=Math.ceil(a*$._pixelDensity),t.height=Math.ceil(o*$._pixelDensity),t.w=a,t.h=o,t.hw=a/2,t.hh=o/2;for(let e in r)$.ctx[e]=r[e];$.ctx.scale($._pixelDensity,$._pixelDensity),$.frameCount&&$.ctx.drawImage(n,0,0,n.w,n.h),$._da?$.flexibleCanvas($._dau):(e.width=a,e.height=o),0!=$.frameCount&&$._adjustDisplay()}$._defaultStyle=()=>{$.ctx.fillStyle="white",$.ctx.strokeStyle="black",$.ctx.lineCap="round",$.ctx.lineJoin="miter",$.ctx.textAlign="left"},$._adjustDisplay=()=>{t.style&&(t.style.width=t.w+"px",t.style.height=t.h+"px")},$.createCanvas=function(a,o,n,r){if("webgl"==n)throw Error("webgl renderer is not supported in q5, use '2d'");"object"==typeof n&&(r=n),e.width=t.width=t.w=a||window.innerWidth,e.height=t.height=t.h=o||window.innerHeight,t.hw=a/2,t.hh=o/2,$._da=0,t.renderer="2d";let i=Object.assign({},Q5.canvasOptions);if(r&&Object.assign(i,r),e.ctx=e.drawingContext=t.getContext("2d",i),Object.assign(t,i),"rgb"==$._colorMode&&$.colorMode("rgb"),$._defaultStyle(),$.ctx.save(),"image"!=$._scope){let e=$.displayDensity();"graphics"==$._scope?e=this._pixelDensity:window.IntersectionObserver&&new IntersectionObserver((e=>{t.visible=e[0].isIntersecting})).observe(t),$.pixelDensity(Math.ceil(e))}else this._pixelDensity=1;return $.displayMode?$.displayMode():$._adjustDisplay(),t},$._createCanvas=$.createCanvas,"image"!=$._scope&&($.resizeCanvas=(e,a)=>{e==t.w&&a==t.h||o(e,a)},$.createGraphics=function(e,t,a){let o=new Q5("graphics");return a??={},a.alpha??=!0,o._createCanvas.call($,e,t,a),o},$._pixelDensity=1,$.displayDensity=()=>window.devicePixelRatio,$.pixelDensity=e=>e&&e!=$._pixelDensity?($._pixelDensity=e,o(t.w,t.h),e):$._pixelDensity,$.fullscreen=e=>{if(void 0===e)return document.fullscreenElement;e?document.body.requestFullscreen():document.body.exitFullscreen()},$.flexibleCanvas=(a=400)=>{a?($._da=t.width/(a*$._pixelDensity),e.width=$._dau=a,e.height=t.h/t.w*a):$._da=0},$.translate=(e,t)=>{$._da&&(e*=$._da,t*=$._da),$.ctx.translate(e,t)},$.rotate=e=>{"degrees"==$._angleMode&&(e=$.radians(e)),$.ctx.rotate(e)},$.scale=(e,t)=>{t??=e,$.ctx.scale(e,t)},$.opacity=e=>$.ctx.globalAlpha=e,$.applyMatrix=(e,t,a,o,n,r)=>$.ctx.transform(e,t,a,o,n,r),$.shearX=e=>$.ctx.transform(1,0,$.tan(e),1,0,0),$.shearY=e=>$.ctx.transform(1,$.tan(e),0,1,0,0),$.resetMatrix=()=>{$.ctx.resetTransform(),$.ctx.scale($._pixelDensity,$._pixelDensity)},$._styleNames=["_doStroke","_doFill","_strokeSet","_fillSet","_tint","_imageMode","_rectMode","_ellipseMode","_textFont","_textLeading","_leadingSet","_textSize","_textAlign","_textBaseline","_textStyle","_textWrap"],$._styles=[],$.push=$.pushMatrix=()=>{$.ctx.save();let e={};for(let t of $._styleNames)e[t]=$[t];$._styles.push(e)},$.pop=$.popMatrix=()=>{$.ctx.restore();let e=$._styles.pop();for(let t of $._styleNames)$[t]=e[t]},$.createCapture=e=>{var t=document.createElement("video");return t.playsinline="playsinline",t.autoplay="autoplay",navigator.mediaDevices.getUserMedia(e).then((e=>{t.srcObject=e})),t.style.position="absolute",t.style.opacity=1e-5,t.style.zIndex=-1e3,document.body.append(t),t},window&&"graphics"!=$._scope&&window.addEventListener("resize",(()=>{$._shouldResize=!0,e.windowWidth=window.innerWidth,e.windowHeight=window.innerHeight,e.deviceOrientation=window.screen?.orientation?.type})))},Q5.canvasOptions={alpha:!1,desynchronized:!1,colorSpace:"display-p3"},window.matchMedia&&matchMedia("(dynamic-range: high) and (color-gamut: p3)").matches?Q5.supportsHDR=!0:Q5.canvasOptions.colorSpace="srgb",Q5.modules.q2d_drawing=$=>{$.CHORD=0,$.PIE=1,$.OPEN=2,$.RADIUS="radius",$.CORNER="corner",$.CORNERS="corners",$.ROUND="round",$.SQUARE="butt",$.PROJECT="square",$.MITER="miter",$.BEVEL="bevel",$.CLOSE=1,$.CENTER="center",$.LEFT="left",$.RIGHT="right",$.TOP="top",$.BOTTOM="bottom",$.LANDSCAPE="landscape",$.PORTRAIT="portrait",$._doStroke=!0,$._doFill=!0,$._strokeSet=!1,$._fillSet=!1,$._ellipseMode=$.CENTER,$._rectMode=$.CORNER,$._curveDetail=20,$._curveAlpha=0;let e=!0,t=[];function a(){$._doFill&&$.ctx.fill(),$._doStroke&&$.ctx.stroke()}function o(e){let t=$._angleMode==$.DEGREES?360:$.TAU;return(e%=t)<0&&(e+=t),e}function n(e,t,n,r,i,s,l,c){if(!$._doFill&&!$._doStroke)return;let d=o(i),h=o(s);if(d>h&&([d,h]=[h,d]),0!=d||0!=h){if($.ctx.beginPath(),n==r)$.ctx.arc(e,t,n/2,d,h);else{for(let a=0;a<c+1;a++){let o=a/c,i=$.lerp(d,h,o),s=$.cos(i)*n/2,l=$.sin(i)*r/2;$.ctx[a?"lineTo":"moveTo"](e+s,t+l)}l==$.CHORD?$.ctx.closePath():l==$.PIE&&($.ctx.lineTo(e,t),$.ctx.closePath())}a()}}function r(e,t,o,n){($._doFill||$._doStroke)&&($._da&&(e*=$._da,t*=$._da,o*=$._da,n*=$._da),$.ctx.beginPath(),$.ctx.ellipse(e,t,o/2,n/2,0,0,$.TAU),a())}function i(e,t,o,n,r,s,l,c){if(!$._doFill&&!$._doStroke)return;if(void 0===r)return function(e,t,a,o){$._da&&(e*=$._da,t*=$._da,a*=$._da,o*=$._da),$._doFill&&$.ctx.fillRect(e,t,a,o),$._doStroke&&$.ctx.strokeRect(e,t,a,o)}(e,t,o,n);if(void 0===s)return i(e,t,o,n,r,r,r,r);$._da&&(e*=$._da,t*=$._da,o*=$._da,n*=$._da,r*=$._da,s*=$._da,c*=$._da,l*=$._da);const d=Math.min(Math.abs(n),Math.abs(o))/2;r=Math.min(d,r),s=Math.min(d,s),c=Math.min(d,c),l=Math.min(d,l),$.ctx.beginPath(),$.ctx.moveTo(e+r,t),$.ctx.arcTo(e+o,t,e+o,t+n,s),$.ctx.arcTo(e+o,t+n,e,t+n,l),$.ctx.arcTo(e,t+n,e,t,c),$.ctx.arcTo(e,t,e+o,t,r),$.ctx.closePath(),a()}function s(){t=[]}$.strokeWeight=e=>{e||($._doStroke=!1),$._da&&(e*=$._da),$.ctx.lineWidth=e||1e-4},$.stroke=function(e){if($._doStroke=!0,$._strokeSet=!0,Q5.Color&&(e._q5Color||"string"==typeof e?$._basicColors[e]&&(e=$.color(...$._basicColors[e])):e=$.color(...arguments),e.a<=0))return $._doStroke=!1;$.ctx.strokeStyle=e.toString()},$.noStroke=()=>$._doStroke=!1,$.fill=function(e){if($._doFill=!0,$._fillSet=!0,Q5.Color&&(e._q5Color||"string"==typeof e?$._basicColors[e]&&(e=$.color(...$._basicColors[e])):e=$.color(...arguments),e.a<=0))return $._doFill=!1;$.ctx.fillStyle=e.toString()},$.noFill=()=>$._doFill=!1,$.blendMode=e=>$.ctx.globalCompositeOperation=e,$.strokeCap=e=>$.ctx.lineCap=e,$.strokeJoin=e=>$.ctx.lineJoin=e,$.ellipseMode=e=>$._ellipseMode=e,$.rectMode=e=>$._rectMode=e,$.curveDetail=e=>$._curveDetail=e,$.curveAlpha=e=>$._curveAlpha=e,$.curveTightness=e=>$._curveAlpha=e,$.clear=()=>{$.ctx.clearRect(0,0,$.canvas.width,$.canvas.height)},$.background=function(e){if(e._q5)return $.image(e,0,0,$.width,$.height);$.ctx.save(),$.ctx.resetTransform(),Q5.Color&&(e._q5Color||"string"==typeof e?$._basicColors[e]&&(e=$.color(...$._basicColors[e])):e=$.color(...arguments)),$.ctx.fillStyle=e.toString(),$.ctx.fillRect(0,0,$.canvas.width,$.canvas.height),$.ctx.restore()},$.line=(e,t,a,o)=>{$._doStroke&&($._da&&(e*=$._da,t*=$._da,a*=$._da,o*=$._da),$.ctx.beginPath(),$.ctx.moveTo(e,t),$.ctx.lineTo(a,o),$.ctx.stroke())},$.arc=(e,t,a,o,r,i,s,l=25)=>{if(r==i)return $.ellipse(e,t,a,o);s??=$.PIE,$._ellipseMode==$.CENTER?n(e,t,a,o,r,i,s,l):$._ellipseMode==$.RADIUS?n(e,t,2*a,2*o,r,i,s,l):$._ellipseMode==$.CORNER?n(e+a/2,t+o/2,a,o,r,i,s,l):$._ellipseMode==$.CORNERS&&n((e+a)/2,(t+o)/2,a-e,o-t,r,i,s,l)},$.ellipse=(e,t,a,o)=>{o??=a,$._ellipseMode==$.CENTER?r(e,t,a,o):$._ellipseMode==$.RADIUS?r(e,t,2*a,2*o):$._ellipseMode==$.CORNER?r(e+a/2,t+o/2,a,o):$._ellipseMode==$.CORNERS&&r((e+a)/2,(t+o)/2,a-e,o-t)},$.circle=(e,t,o)=>{$._ellipseMode==$.CENTER?($._da&&(e*=$._da,t*=$._da,o*=$._da),$.ctx.beginPath(),$.ctx.arc(e,t,o/2,0,$.TAU),a()):$.ellipse(e,t,o,o)},$.point=(e,t)=>{e.x&&(t=e.y,e=e.x),$._da&&(e*=$._da,t*=$._da),$.ctx.save(),$.ctx.beginPath(),$.ctx.arc(e,t,$.ctx.lineWidth/2,0,$.TAU),$.ctx.fillStyle=$.ctx.strokeStyle,$.ctx.fill(),$.ctx.restore()},$.rect=(e,t,a,o,n,r,s,l)=>{$._rectMode==$.CENTER?i(e-a/2,t-o/2,a,o,n,r,s,l):$._rectMode==$.RADIUS?i(e-a,t-o,2*a,2*o,n,r,s,l):$._rectMode==$.CORNER?i(e,t,a,o,n,r,s,l):$._rectMode==$.CORNERS&&i(e,t,a-e,o-t,n,r,s,l)},$.square=(e,t,a,o,n,r,i)=>$.rect(e,t,a,a,o,n,r,i),$.beginShape=()=>{s(),$.ctx.beginPath(),e=!0},$.beginContour=()=>{$.ctx.closePath(),s(),e=!0},$.endContour=()=>{s(),e=!0},$.vertex=(t,a)=>{$._da&&(t*=$._da,a*=$._da),s(),e?$.ctx.moveTo(t,a):$.ctx.lineTo(t,a),e=!1},$.bezierVertex=(e,t,a,o,n,r)=>{$._da&&(e*=$._da,t*=$._da,a*=$._da,o*=$._da,n*=$._da,r*=$._da),s(),$.ctx.bezierCurveTo(e,t,a,o,n,r)},$.quadraticVertex=(e,t,a,o)=>{$._da&&(e*=$._da,t*=$._da,a*=$._da,o*=$._da),s(),$.ctx.quadraticCurveTo(e,t,a,o)},$.bezier=(e,t,a,o,n,r,i,s)=>{$.beginShape(),$.vertex(e,t),$.bezierVertex(a,o,n,r,i,s),$.endShape()},$.triangle=(e,t,a,o,n,r)=>{$.beginShape(),$.vertex(e,t),$.vertex(a,o),$.vertex(n,r),$.endShape($.CLOSE)},$.quad=(e,t,a,o,n,r,i,s)=>{$.beginShape(),$.vertex(e,t),$.vertex(a,o),$.vertex(n,r),$.vertex(i,s),$.endShape($.CLOSE)},$.endShape=e=>{s(),e&&$.ctx.closePath(),a()},$.curveVertex=(a,o)=>{if($._da&&(a*=$._da,o*=$._da),t.push([a,o]),t.length<4)return;let n=function(e,t,a,o,n,r,i,s,l,c){function d(e,t,a,o,n,r){let i=Math.pow(o-t,2)+Math.pow(n-a,2);return Math.pow(i,.5*r)+e}let h=[],u=d(0,e,t,a,o,c),_=d(u,a,o,n,r,c),g=d(_,n,r,i,s,c);for(let c=0;c<l;c++){let d=u+c/(l-1)*(_-u),p=[(u-d)/(u-0),(d-0)/(u-0),(_-d)/(_-u),(d-u)/(_-u),(g-d)/(g-_),(d-_)/(g-_),(_-d)/(_-0),(d-0)/(_-0),(g-d)/(g-u),(d-u)/(g-u)];for(let e=0;e<p.length;e+=2)isNaN(p[e])&&(p[e]=1,p[e+1]=0),isFinite(p[e])||(p[e]>0?(p[e]=1,p[e+1]=0):(p[e]=0,p[e+1]=1));let x=e*p[0]+a*p[1],m=t*p[0]+o*p[1],f=a*p[2]+n*p[3],v=o*p[2]+r*p[3],y=n*p[4]+i*p[5],w=r*p[4]+s*p[5],M=x*p[6]+f*p[7],C=m*p[6]+v*p[7],S=f*p[8]+y*p[9],b=v*p[8]+w*p[9],R=M*p[2]+S*p[3],Q=C*p[2]+b*p[3];h.push([R,Q])}return h}(...t.at(-4),...t.at(-3),...t.at(-2),...t.at(-1),$._curveDetail,$._curveAlpha);for(let t=0;t<n.length;t++)e?$.ctx.moveTo(...n[t]):$.ctx.lineTo(...n[t]),e=!1},$.curve=(e,t,a,o,n,r,i,s)=>{$.beginShape(),$.curveVertex(e,t),$.curveVertex(a,o),$.curveVertex(n,r),$.curveVertex(i,s),$.endShape()},$.curvePoint=(e,t,a,o,n)=>{const r=n*n*n,i=n*n;return e*(-.5*r+i-.5*n)+t*(1.5*r-2.5*i+1)+a*(-1.5*r+2*i+.5*n)+o*(.5*r-.5*i)},$.bezierPoint=(e,t,a,o,n)=>{const r=1-n;return Math.pow(r,3)*e+3*Math.pow(r,2)*n*t+3*r*Math.pow(n,2)*a+Math.pow(n,3)*o},$.curveTangent=(e,t,a,o,n)=>{const r=n*n;return e*(-3*r/2+2*n-.5)+t*(9*r/2-5*n)+a*(-9*r/2+4*n+.5)+o*(3*r/2-n)},$.bezierTangent=(e,t,a,o,n)=>{const r=1-n;return 3*o*Math.pow(n,2)-3*a*Math.pow(n,2)+6*a*r*n-6*t*r*n+3*t*Math.pow(r,2)-3*e*Math.pow(r,2)},$.erase=function(e=255,t=255){$.ctx.save(),$.ctx.globalCompositeOperation="destination-out",$.ctx.fillStyle=`rgba(0, 0, 0, ${e/255})`,$.ctx.strokeStyle=`rgba(0, 0, 0, ${t/255})`},$.noErase=function(){$.ctx.globalCompositeOperation="source-over",$.ctx.restore()}},Q5.modules.q2d_image=($,e)=>{$._tint=null;let t=null,a=null,o=null;function n(e,t){t??=e||$.canvas.height,e??=$.canvas.width,null==a&&(a=new $._OffscreenCanvas(e,t).getContext("2d",{colorSpace:$.canvas.colorSpace})),a.canvas.width==e&&a.canvas.height==t||(a.canvas.width=e,a.canvas.height=t)}function r(e){a.clearRect(0,0,a.canvas.width,a.canvas.height),a.filter=e,a.drawImage($.canvas,0,0),$.ctx.save(),$.ctx.resetTransform(),$.ctx.clearRect(0,0,$.canvas.width,$.canvas.height),$.ctx.drawImage(a.canvas,0,0),$.ctx.restore()}$.loadPixels=()=>{t=$.ctx.getImageData(0,0,$.canvas.width,$.canvas.height),e.pixels=t.data},$.updatePixels=()=>{null!=t&&$.ctx.putImageData(t,0,0)},$._softFilter=()=>{throw"Load q5-2d-soft-filters.js to use software filters."},$.filter=(e,t)=>{if(!$.ctx.filter)return $._softFilter(e,t);if(n(),"string"==typeof e)r(e);else if(e==Q5.THRESHOLD){t??=.5,t=Math.max(t,1e-5),r(`saturate(0%) brightness(${Math.floor(.5/t*100)}%) contrast(1000000%)`)}else e==Q5.GRAY?r("saturate(0%)"):e==Q5.OPAQUE?(a.fillStyle="black",a.fillRect(0,0,a.canvas.width,a.canvas.height),a.drawImage($.canvas,0,0),$.ctx.save(),$.ctx.resetTransform(),$.ctx.drawImage(a.canvas,0,0),$.ctx.restore()):e==Q5.INVERT?r("invert(100%)"):e==Q5.BLUR?r(`blur(${Math.ceil(t*$._pixelDensity/1)||1}px)`):$._softFilter(e,t)},$.resize=(t,o)=>{n(),a.drawImage($.canvas,0,0),e.width=t,e.height=o,$.canvas.width=t*$._pixelDensity,$.canvas.height=o*$._pixelDensity,$.ctx.save(),$.ctx.resetTransform(),$.ctx.clearRect(0,0,$.canvas.width,$.canvas.height),$.ctx.drawImage(a.canvas,0,0,$.canvas.width,$.canvas.height),$.ctx.restore()},$.trim=()=>{let e=$._pixelDensity||1,t=$.ctx.getImageData(0,0,$.width*e,$.height*e).data,a=$.width,o=0,n=$.height,r=0;for(let i=0;i<$.height*e;i++)for(let s=0;s<$.width*e;s++){0!==t[4*(i*$.width*e+s)+3]&&(s<a&&(a=s),s>o&&(o=s),i<n&&(n=i),i>r&&(r=i))}return n=Math.floor(n/e),r=Math.floor(r/e),a=Math.floor(a/e),o=Math.floor(o/e),$.get(a,n,o-a+1,r-n+1)},$.get=(e,t,a,o)=>{let n=$._pixelDensity||1;if(void 0!==e&&void 0===a){let a=$.ctx.getImageData(e*n,t*n,1,1).data;return new $.Color(a[0],a[1],a[2],a[3]/255)}e=(e||0)*n,t=(t||0)*n;let r=a=a||$.width,i=o=o||$.height;a*=n,o*=n;let s=$.createImage(a,o),l=$.ctx.getImageData(e,t,a,o);return s.ctx.putImageData(l,0,0),s._pixelDensity=n,s.width=r,s.height=i,s},$.set=(e,t,a)=>{if(a._q5){let o=$._tint;return $._tint=null,$.image(a,e,t),void($._tint=o)}$.pixels.length||$.loadPixels();let o=$._pixelDensity||1;for(let n=0;n<o;n++)for(let r=0;r<o;r++){let i=4*((t*o+n)*$.canvas.width+e*o+r);$.pixels[i]=a.r??a.l,$.pixels[i+1]=a.g??a.c,$.pixels[i+2]=a.b??a.h,$.pixels[i+3]=a.a}},$.tinted=function(e){let t=e.a;e.a=255,n(),a.clearRect(0,0,a.canvas.width,a.canvas.height),a.fillStyle=e.toString(),a.fillRect(0,0,a.canvas.width,a.canvas.height),a.globalCompositeOperation="multiply",a.drawImage($.ctx.canvas,0,0),a.globalCompositeOperation="source-over",$.ctx.save(),$.ctx.resetTransform();let o=$.ctx.globalCompositeOperation;$.ctx.globalCompositeOperation="source-in",$.ctx.drawImage(a.canvas,0,0),$.ctx.globalCompositeOperation=o,$.ctx.restore(),a.globalAlpha=t/255,a.clearRect(0,0,a.canvas.width,a.canvas.height),a.drawImage($.ctx.canvas,0,0),a.globalAlpha=1,$.ctx.save(),$.ctx.resetTransform(),$.ctx.clearRect(0,0,$.ctx.canvas.width,$.ctx.canvas.height),$.ctx.drawImage(a.canvas,0,0),$.ctx.restore()},$.tint=function(e){$._tint=e._q5Color?e:$.color(...arguments)},$.noTint=()=>$._tint=null,$.mask=e=>{$.ctx.save(),$.ctx.resetTransform();let t=$.ctx.globalCompositeOperation;$.ctx.globalCompositeOperation="destination-in",$.ctx.drawImage(e.canvas,0,0),$.ctx.globalCompositeOperation=t,$.ctx.restore()},$._save=async(e,t,a)=>{if(t=t||"untitled","jpg"==(a=a||"png")||"png"==a||"webp"==a)if(e instanceof OffscreenCanvas){const t=await e.convertToBlob({type:"image/"+a});e=await new Promise((e=>{const a=new FileReader;a.onloadend=()=>e(a.result),a.readAsDataURL(t)}))}else e=e.toDataURL("image/"+a);else{let t="text/plain";"json"==a&&("string"!=typeof e&&(e=JSON.stringify(e)),t="text/json"),e=new Blob([e],{type:t}),e=URL.createObjectURL(e)}let o=document.createElement("a");o.href=e,o.download=t+"."+a,document.body.append(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(o.href)},$.save=(e,t,a)=>{if((!e||"string"==typeof e&&(!t||!a&&t.length<5))&&(a=t,t=e,e=$.canvas),a)return $._save(e,t,a);t?(t=t.split("."),$._save(e,t[0],t.at(-1))):$._save(e)},$.canvas.save=$.save,$.saveCanvas=$.save,$.createImage=(e,t,a)=>new Q5.Image(e,t,a),$._clearTemporaryBuffers=()=>{a=null,o=null,tmpBuf=null},"image"!=$._scope&&($.imageMode=e=>$._imageMode=e,$.image=(e,t,a,n,r,i=0,s=0,l,c)=>{$._da&&(t*=$._da,a*=$._da,n*=$._da,r*=$._da,i*=$._da,s*=$._da,l*=$._da,c*=$._da);let d=e._q5?e.canvas:e;var h,u;Q5._createNodeJSCanvas&&(d=d.context.canvas),e._q5&&null!=$._tint&&(h=e.canvas.width,u=e.canvas.height,u??=h||$.canvas.height,h??=$.canvas.width,null==o&&(o=new $._OffscreenCanvas(h,u).getContext("2d",{colorSpace:$.canvas.colorSpace})),o.canvas.width==h&&o.canvas.height==u||(o.canvas.width=h,o.canvas.height=u),o.drawImage(e.canvas,0,0),e.tinted($._tint)),n??=e.width||e.videoWidth,r??=e.height||e.videoHeight,"center"==$._imageMode&&(t-=.5*n,a-=.5*r);let _=e._pixelDensity||1;l?l*=_:l=d.width||d.videoWidth,c?c*=_:c=d.height||d.videoHeight,$.ctx.drawImage(d,i*_,s*_,l,c,t,a,n,r),function(){if(!e._q5||!$._tint)return;let t=e.ctx;t.save(),t.resetTransform(),t.clearRect(0,0,t.canvas.width,t.canvas.height),t.drawImage(o.canvas,0,0),t.restore()}()},$.loadImage=function(t,a,o){e._preloadCount++;let n=[...arguments].at(-1);o="object"!=typeof n||n;let r=$.createImage(1,1,o.alpha),i=r.ctx;if(Q5._nodejs&&global.CairoCanvas)CairoCanvas.loadImage(t).then((t=>{r.width=i.canvas.width=t.width,r.height=i.canvas.height=t.height,i.drawImage(t,0,0),e._preloadCount--,a&&a(r)})).catch((t=>{throw e._preloadCount--,t}));else{let o=new window.Image;o.src=t,o.crossOrigin="Anonymous",o._pixelDensity=1,o.onload=()=>{r.width=i.canvas.width=o.naturalWidth,r.height=i.canvas.height=o.naturalHeight,i.drawImage(o,0,0),e._preloadCount--,a&&a(r)},o.onerror=t=>{throw e._preloadCount--,t}}return r},$.smooth=()=>$.ctx.imageSmoothingEnabled=!0,$.noSmooth=()=>$.ctx.imageSmoothingEnabled=!1)};class _Q5Image extends Q5{constructor(e,t,a){super("image"),delete this.createCanvas,a??={},a.alpha??=!0,this._createCanvas(e,t,"2d",a),this._loop=!1}get w(){return this.width}get h(){return this.height}}Q5.Image??=_Q5Image,Q5.THRESHOLD=1,Q5.GRAY=2,Q5.OPAQUE=3,Q5.INVERT=4,Q5.POSTERIZE=5,Q5.DILATE=6,Q5.ERODE=7,Q5.BLUR=8,Q5.BLEND="source-over",Q5.REMOVE="destination-out",Q5.ADD="lighter",Q5.DARKEST="darken",Q5.LIGHTEST="lighten",Q5.DIFFERENCE="difference",Q5.SUBTRACT="subtract",Q5.EXCLUSION="exclusion",Q5.MULTIPLY="multiply",Q5.SCREEN="screen",Q5.REPLACE="copy",Q5.OVERLAY="overlay",Q5.HARD_LIGHT="hard-light",Q5.SOFT_LIGHT="soft-light",Q5.DODGE="color-dodge",Q5.BURN="color-burn",Q5.modules.q2d_soft_filters=$=>{let e=null;function t(){let t=$.canvas.width*$.canvas.height*4;e&&t==e.length||(e=new Uint8ClampedArray(t))}$._softFilter=(a,o)=>{$._filters||($._filters=[],$._filters[Q5.THRESHOLD]=(e,t)=>{void 0===t?t=127.5:t*=255;for(let a=0;a<e.length;a+=4){const o=.2126*e[a]+.7152*e[a+1]+.0722*e[a+2];e[a]=e[a+1]=e[a+2]=o>=t?255:0}},$._filters[Q5.GRAY]=e=>{for(let t=0;t<e.length;t+=4){const a=.2126*e[t]+.7152*e[t+1]+.0722*e[t+2];e[t]=e[t+1]=e[t+2]=a}},$._filters[Q5.OPAQUE]=e=>{for(let t=0;t<e.length;t+=4)e[t+3]=255},$._filters[Q5.INVERT]=e=>{for(let t=0;t<e.length;t+=4)e[t]=255-e[t],e[t+1]=255-e[t+1],e[t+2]=255-e[t+2]},$._filters[Q5.POSTERIZE]=(e,t=4)=>{let a=t-1;for(let o=0;o<e.length;o+=4)e[o]=255*(e[o]*t>>8)/a,e[o+1]=255*(e[o+1]*t>>8)/a,e[o+2]=255*(e[o+2]*t>>8)/a},$._filters[Q5.DILATE]=a=>{t(),e.set(a);let[o,n]=[$.canvas.width,$.canvas.height];for(let t=0;t<n;t++)for(let r=0;r<o;r++){let i=4*Math.max(r-1,0),s=4*Math.min(r+1,o-1),l=4*Math.max(t-1,0)*o,c=4*Math.min(t+1,n-1)*o,d=4*t*o,h=4*r;for(let t=0;t<4;t++){let o=t+l,n=t+c,r=t+d;a[d+h+t]=Math.max(e[o+h],e[r+i],e[r+h],e[r+s],e[n+h])}}},$._filters[Q5.ERODE]=a=>{t(),e.set(a);let[o,n]=[$.canvas.width,$.canvas.height];for(let t=0;t<n;t++)for(let r=0;r<o;r++){let i=4*Math.max(r-1,0),s=4*Math.min(r+1,o-1),l=4*Math.max(t-1,0)*o,c=4*Math.min(t+1,n-1)*o,d=4*t*o,h=4*r;for(let t=0;t<4;t++){let o=t+l,n=t+c,r=t+d;a[d+h+t]=Math.min(e[o+h],e[r+i],e[r+h],e[r+s],e[n+h])}}},$._filters[Q5.BLUR]=(a,o)=>{o=o||1,o=Math.floor(o*$._pixelDensity),t(),e.set(a);let n=2*o+1,r=function(e){let t=new Float32Array(e),a=.3*o+.8,n=a*a*2;for(let o=0;o<e;o++){let r=o-e/2,i=Math.exp(-r*r/n)/(2.5066282746*a);t[o]=i}return t}(n),[i,s]=[$.canvas.width,$.canvas.height];for(let t=0;t<s;t++)for(let s=0;s<i;s++){let l=0,c=0,d=0,h=0;for(let a=0;a<n;a++){let n=4*(t*i+Math.min(Math.max(s-o+a,0),i-1));l+=e[n]*r[a],c+=e[n+1]*r[a],d+=e[n+2]*r[a],h+=e[n+3]*r[a]}let u=4*(t*i+s);a[u]=l,a[u+1]=c,a[u+2]=d,a[u+3]=h}e.set(a);for(let t=0;t<s;t++)for(let l=0;l<i;l++){let c=0,d=0,h=0,u=0;for(let a=0;a<n;a++){let n=4*(Math.min(Math.max(t-o+a,0),s-1)*i+l);c+=e[n]*r[a],d+=e[n+1]*r[a],h+=e[n+2]*r[a],u+=e[n+3]*r[a]}let _=4*(t*i+l);a[_]=c,a[_+1]=d,a[_+2]=h,a[_+3]=u}});let n=$.ctx.getImageData(0,0,$.canvas.width,$.canvas.height);$._filters[a](n.data,o),$.ctx.putImageData(n,0,0)}},Q5.modules.q2d_text=($,e)=>{$.NORMAL="normal",$.ITALIC="italic",$.BOLD="bold",$.BOLDITALIC="italic bold",$.CENTER="center",$.LEFT="left",$.RIGHT="right",$.TOP="top",$.BOTTOM="bottom",$.BASELINE="alphabetic",$._textFont="sans-serif",$._textSize=12,$._textLeading=15,$._textLeadDiff=3,$._textStyle="normal",$.loadFont=(t,a)=>{e._preloadCount++;let o=t.split("/"),n=o[o.length-1].split(".")[0].replace(" ",""),r=new FontFace(n,"url("+t+")");return document.fonts.add(r),r.load().then((()=>{e._preloadCount--,a&&a(n)})),n},$.textFont=e=>$._textFont=e,$.textSize=e=>{if(void 0===e)return $._textSize;$._da&&(e*=$._da),$._textSize=e,$._leadingSet||($._textLeading=1.25*e,$._textLeadDiff=$._textLeading-e)},$.textLeading=e=>{if(void 0===e)return $._textLeading;$._da&&(e*=$._da),$._textLeading=e,$._textLeadDiff=e-$._textSize,$._leadingSet=!0},$.textStyle=e=>$._textStyle=e,$.textAlign=(e,t)=>{$.ctx.textAlign=e,t&&($.ctx.textBaseline=t==$.CENTER?"middle":t)},$.textWidth=e=>($.ctx.font=`${$._textStyle} ${$._textSize}px ${$._textFont}`,$.ctx.measureText(e).width),$.textAscent=e=>($.ctx.font=`${$._textStyle} ${$._textSize}px ${$._textFont}`,$.ctx.measureText(e).actualBoundingBoxAscent),$.textDescent=e=>($.ctx.font=`${$._textStyle} ${$._textSize}px ${$._textFont}`,$.ctx.measureText(e).actualBoundingBoxDescent),$._textCache=!!Q5.Image,$._TimedCache=class extends Map{constructor(){super(),this.maxSize=500}set(e,t){t.lastAccessed=Date.now(),super.set(e,t),this.size>this.maxSize&&this.gc()}get(e){const t=super.get(e);return t&&(t.lastAccessed=Date.now()),t}gc(){let e,t=1/0,a=0;for(const[o,n]of this.entries())n.lastAccessed<t&&(t=n.lastAccessed,e=a),a++;a=e;for(const t of this.keys()){if(0==a){e=t;break}a--}this.delete(e)}},$._tic=new $._TimedCache,$.textCache=(e,t)=>(t&&($._tic.maxSize=t),void 0!==e&&($._textCache=e),$._textCache),$._genTextImageKey=(e,t,a)=>e.slice(0,200)+$._textStyle+$._textSize+$._textFont+($._doFill?$.ctx.fillStyle:"")+"_"+($._doStroke&&$._strokeSet?$.ctx.lineWidth+$.ctx.strokeStyle+"_":"")+(t||"")+(a?"x"+a:""),$.createTextImage=(e,t,a)=>{let o=$._textCache;$._textCache=!0,$._genTextImage=!0,$.text(e,0,0,t,a),$._genTextImage=!1;let n=$._genTextImageKey(e,t,a);return $._textCache=o,$._tic.get(n)},$.text=(e,t,a,o,n)=>{if(void 0===e)return;if(e=e.toString(),$._da&&(t*=$._da,a*=$._da),!$._doFill&&!$._doStroke)return;let r,i,s,l,c,d,h,u,_=1,g=$.ctx.getTransform(),p=$._genTextImage||$._textCache&&(0!=g.b||0!=g.c);if(p){if(l=$._genTextImageKey(e,o,n),i=$._tic.get(l),i&&!$._genTextImage)return void $.textImage(i,t,a);s=$.createGraphics.call($,1,1),r=s.ctx,_=$._pixelDensity}else r=$.ctx,c=t,d=a;r.font=`${$._textStyle} ${$._textSize}px ${$._textFont}`;let x=e.split("\n");if(p){c=0,d=$._textLeading*x.length;let t=r.measureText(" ");h=t.fontBoundingBoxAscent,u=t.fontBoundingBoxDescent,n??=d+u,s.resizeCanvas(Math.ceil(r.measureText(e).width),Math.ceil(n)),r.fillStyle=$.ctx.fillStyle,r.strokeStyle=$.ctx.strokeStyle,r.lineWidth=$.ctx.lineWidth}let m=r.fillStyle;$._fillSet||(r.fillStyle="black");for(let e=0;e<x.length&&($._doStroke&&$._strokeSet&&r.strokeText(x[e],c,d),$._doFill&&r.fillText(x[e],c,d),d+=$._textLeading,!(d>n));e++);$._fillSet||(r.fillStyle=m),p&&(i=s.get(),i._ascent=h,i._descent=u,$._tic.set(l,i),$._genTextImage||$.textImage(i,t,a))},$.textImage=(e,t,a)=>{let o=$._imageMode;$._imageMode="corner","center"==$.ctx.textAlign?t-=.5*e.width:"right"==$.ctx.textAlign&&(t-=e.width),"alphabetic"==$.ctx.textBaseline&&(a-=$._textLeading),"middle"==$.ctx.textBaseline?a-=e._descent+.5*e._ascent+$._textLeadDiff:"bottom"==$.ctx.textBaseline?a-=e._ascent+e._descent+$._textLeadDiff:"top"==$.ctx.textBaseline&&(a-=e._descent+$._textLeadDiff),$.image(e,t,a),$._imageMode=o},$.nf=(e,t,a)=>{let o=e<0,n=(e=Math.abs(e)).toFixed(a).split(".");n[0]=n[0].padStart(t,"0");let r=n.join(".");return o&&(r="-"+r),r}},Q5.modules.ai=$=>{$.askAI=(e="")=>{throw Error("Ask AI ✨ "+e)},$._aiErrorAssistance=async e=>{let t=e.message?.includes("Ask AI ✨");if(t||console.error(e),Q5.disableFriendlyErrors)return;!t&&Q5.errorTolerant||noLoop();let a=e.stack?.split("\n");if(!e.stack||a.length<=1)return;let o=1,n="(";for(-1==navigator.userAgent.indexOf("Chrome")&&(o=0,n="@");a[o].indexOf("q5.js:")>=0;)o++;let r=a[o].split(n).at(-1);r=r.split(":");let i=parseInt(r.at(-2));t&&i++;let s=r.slice(0,-2).join(":"),l=s.split("/").at(-1);try{let a=(await(await fetch(s)).text()).split("\n"),o=a[i-1].trim(),n="",r=1;for(;n.length<1600&&(i-r>=0&&(n=a[i-r].trim()+"\n"+n),i+r<a.length);)n+=a[i+r].trim()+"\n",r++;let c="https://chatgpt.com/?q=q5.js+"+(t&&e.message.length>10?e.message.slice(10):"Whats+wrong+with+this+line%3F+short+answer")+(t?"":"%0A%0A"+encodeURIComponent(e.name+": "+e.message))+"%0A%0ALine%3A+"+encodeURIComponent(o)+"%0A%0AExcerpt+for+context%3A%0A%0A"+encodeURIComponent(n);t||console.log("Error in "+l+" on line "+i+":\n\n"+o),console.warn("Ask AI ✨ "+c),t&&window.open(c,"_blank")}catch(e){}}},Q5.modules.color=($,e)=>{$.RGB=$.RGBA=$._colorMode="rgb",Q5.supportsHDR?$.Color=Q5.ColorRGBA_P3:$.Color=Q5.ColorRGBA,$.colorMode=t=>{$._colorMode=t,"oklch"==t?e.Color=Q5.ColorOKLCH:"rgb"==t?"srgb"==$.canvas.colorSpace?e.Color=Q5.ColorRGBA:e.Color=Q5.ColorRGBA_P3:"srgb"==t&&(e.Color=Q5.ColorRGBA,$._colorMode="rgb")},$._basicColors={aqua:[0,255,255],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],crimson:[220,20,60],cyan:[0,255,255],darkviolet:[148,0,211],gold:[255,215,0],green:[0,128,0],gray:[128,128,128],grey:[128,128,128],hotpink:[255,105,180],indigo:[75,0,130],khaki:[240,230,140],lightgreen:[144,238,144],lime:[0,255,0],magenta:[255,0,255],navy:[0,0,128],orange:[255,165,0],olive:[128,128,0],peachpuff:[255,218,185],pink:[255,192,203],purple:[128,0,128],red:[255,0,0],skyblue:[135,206,235],tan:[210,180,140],turquoise:[64,224,208],transparent:[0,0,0,0],white:[255,255,255],violet:[238,130,238],yellow:[255,255,0]},$.color=function(e,t,a,o){let n=$.Color;if(e._q5Color)return new n(...e.levels);let r=arguments;if(1==r.length){if("string"==typeof e)return"#"==e[0]?new n(parseInt(e.slice(1,3),16),parseInt(e.slice(3,5),16),parseInt(e.slice(5,7),16),9!=e.length?null:parseInt(e.slice(7,9),16)):$._basicColors[e]?new n(...$._basicColors[e]):new n(0,0,0);if(Array.isArray(e))return new n(...e)}if("rgb"==$._colorMode){if(1==r.length)return new n(e,e,e);if(2==r.length)return new n(e,e,e,t);if(3==r.length)return new n(e,t,a);if(4==r.length)return new n(e,t,a,o)}},$.red=e=>e.r,$.green=e=>e.g,$.blue=e=>e.b,$.alpha=e=>e.a,$.lightness=e=>100*(.2126*e.r+.7152*e.g+.0722*e.b)/255,$.lerpColor=(e,t,a)=>{if("rgb"==$._colorMode)return new $.Color($.constrain($.lerp(e.r,t.r,a),0,255),$.constrain($.lerp(e.g,t.g,a),0,255),$.constrain($.lerp(e.b,t.b,a),0,255),$.constrain($.lerp(e.a,t.a,a),0,255));{let o=t.h-e.h;o>180&&(o-=360),o<-180&&(o+=360);let n=e.h+a*o;return n<0&&(n+=360),n>360&&(n-=360),
new $.Color($.constrain($.lerp(e.l,t.l,a),0,100),$.constrain($.lerp(e.c,t.c,a),0,100),n,$.constrain($.lerp(e.a,t.a,a),0,255))}}},Q5.Color=class{constructor(){this._q5Color=!0}},Q5.ColorOKLCH=class extends Q5.Color{constructor(e,t,a,o){super(),this.l=e,this.c=t,this.h=a,this.a=o??1}toString(){return`color(oklch ${this.l} ${this.c} ${this.h} / ${this.a})`}},Q5.ColorRGBA=class extends Q5.Color{constructor(e,t,a,o){super(),this.r=e,this.g=t,this.b=a,this.a=o??255}setRed(e){this.r=e}setGreen(e){this.g=e}setBlue(e){this.b=e}setAlpha(e){this.a=e}get levels(){return[this.r,this.g,this.b,this.a]}toString(){return`rgb(${this.r} ${this.g} ${this.b} / ${this.a/255})`}},Q5.ColorRGBA_P3=class extends Q5.ColorRGBA{constructor(e,t,a,o){super(e,t,a,o),this._edited=!0}get r(){return this._r}set r(e){this._r=e,this._edited=!0}get g(){return this._g}set g(e){this._g=e,this._edited=!0}get b(){return this._b}set b(e){this._b=e,this._edited=!0}get a(){return this._a}set a(e){this._a=e,this._edited=!0}toString(){if(this._edited){let e=(this._r/255).toFixed(3),t=(this._g/255).toFixed(3),a=(this._b/255).toFixed(3),o=(this._a/255).toFixed(3);this._css=`color(display-p3 ${e} ${t} ${a} / ${o})`,this._edited=!1}return this._css}},Q5.modules.display=$=>{if(!$.canvas||"graphics"==$._scope)return;let e=$.canvas;0!=Q5._instanceCount||Q5._nodejs||document.head.insertAdjacentHTML("beforeend","<style>\nhtml, body {\n\tmargin: 0;\n\tpadding: 0;\n}\n.q5Canvas {\n\toutline: none;\n\t-webkit-touch-callout: none;\n\t-webkit-text-size-adjust: none;\n\t-webkit-user-select: none;\n\toverscroll-behavior: none;\n}\n.q5-pixelated {\n\timage-rendering: pixelated;\n\tfont-smooth: never;\n\t-webkit-font-smoothing: none;\n}\n.q5-centered,\n.q5-maxed,\n.q5-fullscreen {\n  display: flex;\n\talign-items: center;\n\tjustify-content: center;\n}\nmain.q5-centered,\nmain.q5-maxed,\n.q5-fullscreen {\n\theight: 100vh;\n}\nmain {\n\toverscroll-behavior: none;\n}\n</style>"),$._adjustDisplay=()=>{let t=e.style,a=e.parentElement;t&&a&&e.displayMode&&("pixelated"==e.renderQuality&&(e.classList.add("q5-pixelated"),$.pixelDensity(1),$.noSmooth&&$.noSmooth(),$.textFont&&$.textFont("monospace")),"normal"==e.displayMode?(a.classList.remove("q5-centered","q5-maxed","q5-fullscreen"),t.width=e.w*e.displayScale+"px",t.height=e.h*e.displayScale+"px"):(a.classList.add("q5-"+e.displayMode),a=a.getBoundingClientRect(),e.w/e.h>a.width/a.height?("centered"==e.displayMode?(t.width=e.w*e.displayScale+"px",t.maxWidth="100%"):t.width="100%",t.height="auto",t.maxHeight=""):(t.width="auto",t.maxWidth="","centered"==e.displayMode?(t.height=e.h*e.displayScale+"px",t.maxHeight="100%"):t.height="100%")))},$.displayMode=(t="normal",a="default",o=1)=>{"string"==typeof o&&(o=parseFloat(o.slice(1))),Object.assign(e,{displayMode:t,renderQuality:a,displayScale:o}),$._adjustDisplay()}},Q5.modules.input=($,e)=>{$.mouseX=0,$.mouseY=0,$.pmouseX=0,$.pmouseY=0,$.touches=[],$.mouseButton=null,$.keyIsPressed=!1,$.mouseIsPressed=!1,$.key=null,$.keyCode=null,$.ALT=18,$.BACKSPACE=8,$.CONTROL=17,$.DELETE=46,$.DOWN_ARROW=40,$.ENTER=13,$.ESCAPE=27,$.LEFT_ARROW=37,$.OPTION=18,$.RETURN=13,$.RIGHT_ARROW=39,$.SHIFT=16,$.TAB=9,$.UP_ARROW=38,$.ARROW="default",$.CROSS="crosshair",$.HAND="pointer",$.MOVE="move",$.TEXT="text";let t={},a=[$.LEFT,$.CENTER,$.RIGHT];function o(e){const t=$.canvas.getBoundingClientRect(),a=$.canvas.scrollWidth/$.width||1,o=$.canvas.scrollHeight/$.height||1;return{x:(e.clientX-t.left)/a,y:(e.clientY-t.top)/o,id:e.identifier}}$._startAudio=()=>{$.getAudioContext&&"suspended"==$.getAudioContext()?.state&&$.userStartAudio()},$._updateMouse=t=>{if(t.changedTouches)return;let a=$.canvas.getBoundingClientRect(),o=$.canvas.scrollWidth/$.width||1,n=$.canvas.scrollHeight/$.height||1;e.mouseX=(t.clientX-a.left)/o,e.mouseY=(t.clientY-a.top)/n},$._onmousedown=t=>{$._startAudio(),$._updateMouse(t),e.mouseIsPressed=!0,e.mouseButton=a[t.button],$.mousePressed(t)},$._onmousemove=e=>{$._updateMouse(e),$.mouseIsPressed?$.mouseDragged(e):$.mouseMoved(e)},$._onmouseup=t=>{$._updateMouse(t),e.mouseIsPressed=!1,$.mouseReleased(t)},$._onclick=t=>{$._updateMouse(t),e.mouseIsPressed=!0,$.mouseClicked(t),e.mouseIsPressed=!1},$.cursor=(e,t,a)=>{let o="";e.includes(".")&&(e=`url("${e}")`,o=", auto"),void 0!==t&&(e+=" "+t+" "+a),$.canvas.style.cursor=e+o},$.noCursor=()=>{$.canvas.style.cursor="none"},$._onkeydown=a=>{a.repeat||($._startAudio,e.keyIsPressed=!0,e.key=a.key,e.keyCode=a.keyCode,t[$.keyCode]=!0,$.keyPressed(a),1==a.key.length&&$.keyTyped(a))},$._onkeyup=a=>{e.keyIsPressed=!1,e.key=a.key,e.keyCode=a.keyCode,t[$.keyCode]=!1,$.keyReleased(a)},$._ontouchstart=t=>{$._startAudio(),e.touches=[...t.touches].map(o),$._isTouchAware||(e.mouseX=$.touches[0].x,e.mouseY=$.touches[0].y,e.mouseIsPressed=!0,e.mouseButton=$.LEFT,$.mousePressed(t)||t.preventDefault()),$.touchStarted(t)||t.preventDefault()},$._ontouchmove=t=>{e.touches=[...t.touches].map(o),$._isTouchAware||(e.mouseX=$.touches[0].x,e.mouseY=$.touches[0].y,$.mouseDragged(t)||t.preventDefault()),$.touchMoved(t)||t.preventDefault()},$._ontouchend=t=>{e.touches=[...t.touches].map(o),$._isTouchAware||$.touches.length||(e.mouseIsPressed=!1,$.mouseReleased(t)||t.preventDefault()),$.touchEnded(t)||t.preventDefault()},$.requestPointerLock=document.body.requestPointerLock,$.exitPointerLock=document.exitPointerLock,"graphics"!=$._scope&&($.keyIsDown=e=>!!t[e],$.canvas.onmousedown=e=>$._onmousedown(e),$.canvas.onmouseup=e=>$._onmouseup(e),$.canvas.onclick=e=>$._onclick(e),$.canvas.ontouchstart=e=>$._ontouchstart(e),$.canvas.ontouchmove=e=>$._ontouchmove(e),$.canvas.ontouchcancel=$.canvas.ontouchend=e=>$._ontouchend(e),window&&(window.addEventListener("mousemove",(e=>$._onmousemove(e)),!1),window.addEventListener("keydown",(e=>$._onkeydown(e)),!1),window.addEventListener("keyup",(e=>$._onkeyup(e)),!1)))},Q5.modules.math=($,e)=>{function t(){let e,t,a=4294967295;return{setSeed(o){e=t=(null==o?Math.random()*a:o)>>>0},getSeed:()=>t,rand:()=>(e^=e<<17,e^=e>>13,e^=e<<5,(e>>>0)/a)}}$.DEGREES="degrees",$.RADIANS="radians",$.PI=Math.PI,$.HALF_PI=Math.PI/2,$.QUARTER_PI=Math.PI/4,$.abs=Math.abs,$.ceil=Math.ceil,$.exp=Math.exp,$.floor=Math.floor,$.loge=Math.log,$.mag=Math.hypot,$.max=Math.max,$.min=Math.min,$.round=Math.round,$.pow=Math.pow,$.sqrt=Math.sqrt,$.SHR3=1,$.LCG=2,$.angleMode=e=>$._angleMode=e,$._DEGTORAD=Math.PI/180,$._RADTODEG=180/Math.PI,$.degrees=e=>e*$._RADTODEG,$.radians=e=>e*$._DEGTORAD,$.map=(e,t,a,o,n,r)=>{let i=o+1*(e-t)/(a-t)*(n-o);return r?o<n?Math.min(Math.max(i,o),n):Math.min(Math.max(i,n),o):i},$.lerp=(e,t,a)=>e*(1-a)+t*a,$.constrain=(e,t,a)=>Math.min(Math.max(e,t),a),$.dist=function(){let e=arguments;return 4==e.length?Math.hypot(e[0]-e[2],e[1]-e[3]):Math.hypot(e[0]-e[3],e[1]-e[4],e[2]-e[5])},$.norm=(e,t,a)=>$.map(e,t,a,0,1),$.sq=e=>e*e,$.fract=e=>e-Math.floor(e),$.sin=e=>("degrees"==$._angleMode&&(e=$.radians(e)),Math.sin(e)),$.cos=e=>("degrees"==$._angleMode&&(e=$.radians(e)),Math.cos(e)),$.tan=e=>("degrees"==$._angleMode&&(e=$.radians(e)),Math.tan(e)),$.asin=e=>{let t=Math.asin(e);return"degrees"==$._angleMode&&(t=$.degrees(t)),t},$.acos=e=>{let t=Math.acos(e);return"degrees"==$._angleMode&&(t=$.degrees(t)),t},$.atan=e=>{let t=Math.atan(e);return"degrees"==$._angleMode&&(t=$.degrees(t)),t},$.atan2=(e,t)=>{let a=Math.atan2(e,t);return"degrees"==$._angleMode&&(a=$.degrees(a)),a};let a=t();a.setSeed(),$.randomSeed=e=>a.setSeed(e),$.random=(e,t)=>void 0===e?a.rand():"number"==typeof e?void 0!==t?a.rand()*(t-e)+e:a.rand()*e:e[Math.trunc(e.length*a.rand())],$.randomGenerator=e=>{e==$.LCG?a=function(){const e=4294967296;let t,a;return{setSeed(o){a=t=(null==o?Math.random()*e:o)>>>0},getSeed:()=>t,rand:()=>(a=(1664525*a+1013904223)%e,a/e)}}():e==$.SHR3&&(a=t()),a.setSeed()};var o=new function(){var e,t,o,n=new Array(128),r=new Array(256),i=new Array(128),s=new Array(128),l=new Array(256),c=new Array(256),d=()=>4294967296*a.rand()-2147483648,h=()=>.5+2.328306e-10*(d()<<0),u=()=>{for(var t,a,r,l,c=3.44262;;){if(t=o*i[e],0==e){do{r=h(),l=h(),t=.2904764*-Math.log(r),a=-Math.log(l)}while(a+a<t*t);return o>0?c+t:-c-t}if(s[e]+h()*(s[e-1]-s[e])<Math.exp(-.5*t*t))return t;if(o=d(),e=127&o,Math.abs(o)<n[e])return o*i[e]}},_=()=>{for(var a;;){if(0==e)return 7.69711-Math.log(h());if(a=t*l[e],c[e]+h()*(c[e-1]-c[e])<Math.exp(-a))return a;if((t=d())<r[e=255&t])return t*l[e]}};this.SHR3=d,this.UNI=h,this.RNOR=()=>(o=d(),e=127&o,Math.abs(o)<n[e]?o*i[e]:u()),this.REXP=()=>(t=d()>>>0)<n[e=255&t]?t*l[e]:_(),this.zigset=()=>{var e,t,a=2147483648,o=4294967296,d=3.442619855899,h=d,u=.00991256303526217,_=7.697117470131487,g=_,p=.003949659822581572;for(e=u/Math.exp(-.5*d*d),n[0]=Math.floor(d/e*a),n[1]=0,i[0]=e/a,i[127]=d/a,s[0]=1,s[127]=Math.exp(-.5*d*d),t=126;t>=1;t--)d=Math.sqrt(-2*Math.log(u/d+Math.exp(-.5*d*d))),n[t+1]=Math.floor(d/h*a),h=d,s[t]=Math.exp(-.5*d*d),i[t]=d/a;for(e=p/Math.exp(-_),r[0]=Math.floor(_/e*o),r[1]=0,l[0]=e/o,l[255]=_/o,c[0]=1,c[255]=Math.exp(-_),t=254;t>=1;t--)_=-Math.log(p/_+Math.exp(-_)),r[t+1]=Math.floor(_/g*o),g=_,c[t]=Math.exp(-_),l[t]=_/o}};let n;o.hasInit=!1,$.randomGaussian=(e,t)=>(o.hasInit||(o.zigset(),o.hasInit=!0),o.RNOR()*t+e),$.randomExponential=()=>(o.hasInit||(o.zigset(),o.hasInit=!0),o.REXP()),$.PERLIN="perlin",$.SIMPLEX="simplex",$.BLOCKY="blocky",$.Noise=Q5.PerlinNoise,$.noiseMode=t=>{e.Noise=Q5[t[0].toUpperCase()+t.slice(1)+"Noise"],n=null},$.noiseSeed=e=>{n=new $.Noise(e)},$.noise=(e=0,t=0,a=0)=>(n??=new $.Noise,n.noise(e,t,a)),$.noiseDetail=(e,t)=>{n??=new $.Noise,e>0&&(n.octaves=e),t>0&&(n.falloff=t)}},Q5.Noise=class{constructor(){}},Q5.PerlinNoise=class extends Q5.Noise{constructor(e){super(),this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.octaves=1,this.falloff=.5,this.p=null==e?Array.from({length:256},(()=>Math.floor(256*Math.random()))):this.seedPermutation(e),this.p=this.p.concat(this.p)}seedPermutation(e){let t,a,o=[];for(let e=0;e<256;e++)o[e]=e;for(let n=255;n>0;n--)t=(e=16807*e%2147483647)%(n+1),a=o[n],o[n]=o[t],o[t]=a;return o}dot(e,t,a,o){return e[0]*t+e[1]*a+e[2]*o}mix(e,t,a){return(1-a)*e+a*t}fade(e){return e*e*e*(e*(6*e-15)+10)}noise(e,t,a){let o=this,n=0,r=1,i=1,s=0;for(let l=0;l<o.octaves;l++){const l=255&Math.floor(e*r),c=255&Math.floor(t*r),d=255&Math.floor(a*r),h=e*r-Math.floor(e*r),u=t*r-Math.floor(t*r),_=a*r-Math.floor(a*r),g=o.fade(h),p=o.fade(u),x=o.fade(_),m=o.p[l]+c,f=o.p[m]+d,v=o.p[m+1]+d,y=o.p[l+1]+c,w=o.p[y]+d,M=o.p[y+1]+d,C=o.mix(o.dot(o.grad3[o.p[f]%12],h,u,_),o.dot(o.grad3[o.p[w]%12],h-1,u,_),g),S=o.mix(o.dot(o.grad3[o.p[v]%12],h,u-1,_),o.dot(o.grad3[o.p[M]%12],h-1,u-1,_),g),b=o.mix(o.dot(o.grad3[o.p[f+1]%12],h,u,_-1),o.dot(o.grad3[o.p[w+1]%12],h-1,u,_-1),g),R=o.mix(o.dot(o.grad3[o.p[v+1]%12],h,u-1,_-1),o.dot(o.grad3[o.p[M+1]%12],h-1,u-1,_-1),g),Q=o.mix(C,S,p),E=o.mix(b,R,p);n+=o.mix(Q,E,x)*i,s+=i,i*=o.falloff,r*=2}return(n/s+1)/2}},Q5.modules.sound=($,e)=>{$.loadSound=(t,a)=>{e._preloadCount++,$.aud??=new window.AudioContext;let o=new Audio(t);return o.addEventListener("canplaythrough",(()=>{e._preloadCount--,a&&a(o)})),o.load(),o.setVolume=e=>o.volume=e,o.setLoop=e=>o.loop=e,o.panner=$.aud.createStereoPanner(),o.source=$.aud.createMediaElementSource(o),o.source.connect(o.panner),o.panner.connect($.aud.destination),Object.defineProperty(o,"pan",{get:()=>o.panner.pan.value,set:e=>o.panner.pan.value=e}),o.setPan=e=>o.pan=e,o},$.getAudioContext=()=>$.aud,$.userStartAudio=()=>$.aud.resume()},Q5.modules.util=($,e)=>{$._loadFile=(t,a,o)=>{e._preloadCount++;let n={};return fetch(t).then((e=>"json"==o?e.json():"text"==o?e.text():void 0)).then((t=>{e._preloadCount--,Object.assign(n,t),a&&a(t)})),n},$.loadStrings=(e,t)=>$._loadFile(e,t,"text"),$.loadJSON=(e,t)=>$._loadFile(e,t,"json"),"object"==typeof localStorage&&($.storeItem=localStorage.setItem,$.getItem=localStorage.getItem,$.removeItem=localStorage.removeItem,$.clearStorage=localStorage.clear),$.year=()=>(new Date).getFullYear(),$.day=()=>(new Date).getDay(),$.hour=()=>(new Date).getHours(),$.minute=()=>(new Date).getMinutes(),$.second=()=>(new Date).getSeconds()},Q5.modules.vector=$=>{$.createVector=(e,t,a)=>new Q5.Vector(e,t,a,$)},Q5.Vector=class{constructor(e,t,a,o){this.x=e||0,this.y=t||0,this.z=a||0,this._$=o||window,this._cn=null,this._cnsq=null}set(e,t,a){this.x=e||0,this.y=t||0,this.z=a||0}copy(){return new Q5.Vector(this.x,this.y,this.z)}_arg2v(e,t,a){return void 0!==e.x?e:void 0!==t?{x:e,y:t,z:a||0}:{x:e,y:e,z:e}}_calcNorm(){this._cnsq=this.x*this.x+this.y*this.y+this.z*this.z,this._cn=Math.sqrt(this._cnsq)}add(){let e=this._arg2v(...arguments);return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}rem(){let e=this._arg2v(...arguments);return this.x%=e.x,this.y%=e.y,this.z%=e.z,this}sub(){let e=this._arg2v(...arguments);return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}mult(){let e=this._arg2v(...arguments);return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}div(){let e=this._arg2v(...arguments);return e.x?this.x/=e.x:this.x=0,e.y?this.y/=e.y:this.y=0,e.z?this.z/=e.z:this.z=0,this}mag(){return this._calcNorm(),this._cn}magSq(){return this._calcNorm(),this._cnsq}dot(){let e=this._arg2v(...arguments);return this.x*e.x+this.y*e.y+this.z*e.z}dist(){let e=this._arg2v(...arguments),t=this.x-e.x,a=this.y-e.y,o=this.z-e.z;return Math.sqrt(t*t+a*a+o*o)}cross(){let e=this._arg2v(...arguments),t=this.y*e.z-this.z*e.y,a=this.z*e.x-this.x*e.z,o=this.x*e.y-this.y*e.x;return this.x=t,this.y=a,this.z=o,this}normalize(){this._calcNorm();let e=this._cn;return 0!=e&&(this.x/=e,this.y/=e,this.z/=e),this._cn=1,this._cnsq=1,this}limit(e){this._calcNorm();let t=this._cn;if(t>e){let a=e/t;this.x*=a,this.y*=a,this.z*=a,this._cn=e,this._cnsq=e*e}return this}setMag(e){this._calcNorm();let t=e/this._cn;return this.x*=t,this.y*=t,this.z*=t,this._cn=e,this._cnsq=e*e,this}heading(){return this._$.atan2(this.y,this.x)}rotate(e){let t=this._$.cos(e),a=this._$.sin(e),o=this.x*t-this.y*a,n=this.x*a+this.y*t;return this.x=o,this.y=n,this}angleBetween(){let e=this._arg2v(...arguments),t=Q5.Vector.cross(this,e);return this._$.atan2(t.mag(),this.dot(e))*Math.sign(t.z||1)}lerp(){let e=[...arguments],t=this._arg2v(...e.slice(0,-1)),a=e[e.length-1];return this.x+=(t.x-this.x)*a,this.y+=(t.y-this.y)*a,this.z+=(t.z-this.z)*a,this}reflect(e){return e.normalize(),this.sub(e.mult(2*this.dot(e)))}array(){return[this.x,this.y,this.z]}equals(e,t){return t??=Number.EPSILON||0,Math.abs(e.x-this.x)<t&&Math.abs(e.y-this.y)<t&&Math.abs(e.z-this.z)<t}fromAngle(e,t){return void 0===t&&(t=1),this._cn=t,this._cnsq=t*t,this.x=t*this._$.cos(e),this.y=t*this._$.sin(e),this.z=0,this}fromAngles(e,t,a){void 0===a&&(a=1),this._cn=a,this._cnsq=a*a;const o=this._$.cos(t),n=this._$.sin(t),r=this._$.cos(e),i=this._$.sin(e);return this.x=a*i*n,this.y=-a*r,this.z=a*i*o,this}random2D(){return this._cn=this._cnsq=1,this.fromAngle(Math.random()*Math.PI*2)}random3D(){return this._cn=this._cnsq=1,this.fromAngles(Math.random()*Math.PI*2,Math.random()*Math.PI*2)}toString(){return`[${this.x}, ${this.y}, ${this.z}]`}},Q5.Vector.add=(e,t)=>e.copy().add(t),Q5.Vector.cross=(e,t)=>e.copy().cross(t),Q5.Vector.dist=(e,t)=>Math.hypot(e.x-t.x,e.y-t.y,e.z-t.z),Q5.Vector.div=(e,t)=>e.copy().div(t),Q5.Vector.dot=(e,t)=>e.copy().dot(t),Q5.Vector.equals=(e,t,a)=>e.equals(t,a),Q5.Vector.lerp=(e,t,a)=>e.copy().lerp(t,a),Q5.Vector.limit=(e,t)=>e.copy().limit(t),Q5.Vector.heading=e=>this._$.atan2(e.y,e.x),Q5.Vector.magSq=e=>e.x*e.x+e.y*e.y+e.z*e.z,Q5.Vector.mag=e=>Math.sqrt(Q5.Vector.magSq(e)),Q5.Vector.mult=(e,t)=>e.copy().mult(t),Q5.Vector.normalize=e=>e.copy().normalize(),Q5.Vector.rem=(e,t)=>e.copy().rem(t),Q5.Vector.sub=(e,t)=>e.copy().sub(t);for(let e of["fromAngle","fromAngles","random2D","random3D"])Q5.Vector[e]=(t,a,o)=>(new Q5.Vector)[e](t,a,o);